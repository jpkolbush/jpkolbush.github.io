<!DOCTYPE html>
<meta charset="utf-8">
<style>
.axis path,
.axis line {
  fill: none;
  stroke: #000;
}
</style>
<body>
<h1>Current Scores</h1>
<script src="../lib/d3.v3.min.js"></script>
<script>
	c = [1, 1, 1.1666666666666667,
			1.4111111111111112,
			1.7337301587301588,
			2.14858024691358,
			2.6771662391106834,
			3.3481463612812816,
			4.198493963426833,
			5.275422686461255,
			6.638995094615459,
			8.365504501912918,
			10.551802021076062,
			13.320808170226233,
			16.828521535783903,
			21.272925305378422,
			26.905302783242664,
			34.044612310259325,
			43.09574865388233,
			54.572742243500116,
			69.12823263611968,
			87.5909148253449,
			111.01311743420455,
			140.73125712451855,
			178.4426576114869,
			226.30316759389552,
			287.0512145039826,
			364.1654599384032,
			462.0651665758136,
			586.3648580165928,
			744.1979956155378,
			944.6283922815563,
			1199.1731641812473,
			1522.4674820915277,
			1933.1095997060772,
			2454.7350833215687,
			3117.382452435591,
			3959.229335160556,
			5028.7997269694015,
			6387.77026383145,
			8114.538168223919,
			10308.757717309176,
			13097.108284167014,
			16640.62848102773,
			21144.041841829647,
			26867.615103829852,
			34142.23720537835,
			43388.5941585717,
			55141.55285636318,
			70081.16946751578,
			89072.12295703808]
	std = 20.77989
	w = 600
	h = 600
	generateRecord()
	//Bambitron(40000)
	function genScores() {
		//SWAPPING ROWS AND COLUMNS FROM THE R CODE!
		cScores = [[111,98,81,83,61,105,68,149,86,97,94,100],
			   [92,103,61,71,83,109,115,92,111,66,95,55],
			   [76, 85, 117, 89, 112, 72, 75, 76, 82, 67, 113, 106],
			   [88, 66, 121, 52, 85, 92, 72, 70, 124, 61, 126, 76],
			   [51,70,108,75,130,128,74,80,50,81,90,80],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0],
			   [0,0,0,0,0,0,0,0,0,0,0,0]]

		var i = 0
		while (i < 12) {
	 		var j = 0
			var curr = 100
			var tot = 0
			while (curr != 0) {
				curr = cScores[j][i]
				tot = tot + curr
				j = j + 1
			}

			var avg = tot/ (j-1)
			//console.log(avg)
			j = j - 1
			while (j < 16) {
				r = Math.random()
				erf = 0
				k = 0
				
				while (k < 40) {
					erf = erf + c[k] * ((Math.sqrt(Math.PI)*(2*r -1)/2.0)**(2*k+1))/(2*k + 1)
					k = k + 1
				}
				
				cScores[j][i] = Math.round(erf * std * Math.sqrt(2) + avg)
				j = j + 1
				
			
			}
			i = i + 1
			

		}
		return cScores
	}
	function generateRecord() {
		s = genScores()
		//row is a team, column is a week
		matchups = [[2,3,5,4,1,7,11,9,6,10,8,7],
                [4,2,3,5,0,6,10,8,7,11,9,6],
                [0,1,4,3,5,11,9,6,10,8,7,11],
                [5,0,1,2,4,8,7,11,9,6,10,8],
                [1,5,2,0,3,10,8,7,11,9,6,10],
                [3,4,0,1,2,9,6,10,8,7,11,9],
                [10,11,8,9,7,1,5,2,0,3,4,1],
                [11,8,9,10,6,0,3,4,1,5,2,0],
                [9,7,6,11,10,3,4,1,5,2,0,3],
                [8,10,7,6,11,5,2,0,3,4,1,5],
                [6,9,11,7,8,4,1,5,2,0,3,4],
                [7,6,10,8,9,2,0,3,4,1,5,2]]
		}
		records = []
		// records header = ['Name', Wins', 'Losses', "PF", "Seed", "Made Playoffs",
		// "Champ", "Bottom 4", "Bolan"]

		teamNames = ["Team1", "Team2", "Team3", "Team4",
					"Team5", "Team6", "Team7", "Team8",
					"Team9", "Team10", "Team11", "Team12"]
		//each row is a team
		i = 0 
		while (i < 12) {
			records.push([teamNames[i],0,0,0,0,13,0,0,0,0,0])
			i = i + 1
		}
		//i is team number
		i = 0
		while (i < 12) {
			scoreTot = 0
			// j is the week
			j = 0
			while (j < 12) {
				Ascore = s[j][i]
				Bscore = s[j][matchups[i][j]]
				scoreTot = scoreTot + Ascore
				if (Ascore > Bscore) {
					records[i][1] = records[i][1] + 1
				}
				else if (Ascore < Bscore) {
					records[i][2] = records[i][2] + 1
				}
				else {
					records[i][1] = records[i][1] + 0.5
					records[i][2] = records[i][2] + 0.5
				}
				j = j + 1

			}
			records[i][3] = scoreTot
			i = i + 1
		}
		div1 = records.slice(0,6)
		div2 = records.slice(6)
		div1.sort(function (a,b) {
			if (a[1] < b[1]) {
				return true
			} else if (a[1] > b[1]) {
				return false
			} else{
				return (a[3] < b[3])
			}
		})
		div2.sort(function (a,b) {
			if (a[1] < b[1]) {
				return true
			} else if (a[1] > b[1]) {
				return false
			} else{
				return (a[3] < b[3])
			}
		})
		console.log(div1)
		console.log(div2)
		records.sort(function (a,b) {
			if (a[1] < b[1]) {
				return true
			} else if (a[1] > b[1]) {
				return false
			} else{
				return (a[3] < b[3])
			}
		})
		nRecords = []
		if (div1[0][1] > div2[0][1] || 
			(div1[0][1] == div2[0][1]) && div1[0][3] > div2[0][3]) {

			div1[0][4] = 1
			div1[0][5] = 1
			div2[0][4] = 2
			div2[0][5] = 1
			nRecords.push(div1[0])
			nRecords.push(div2[0])
		}
		else {
			div1[0][4] = 2
			div1[0][5] = 1
			div2[0][4] = 1
			div2[0][5] = 1
			nRecords.push(div2[0])
			nRecords.push(div1[0])
		}

		curr = 3
		//merge div1 and div2 together
		i1 = 1
		i2 = 1
		while (i1 < 6 && i2 < 6){
			if (div1[i1][1] > div2[i2][1] || 
			(div1[i1][1] == div2[i2][1]) && div1[i1][3] > div2[i2][3]) {
				div1[i1][4] = curr
				nRecords.push(div1[i1])
				i1 = i1 + 1
			}
			else {
				div1[i2][4] = curr
				nRecords.push(div2[i2])
				i2 = i2 + 1
			}
			curr = curr + 1
		}
		if (i1 ==5) {
			nRecords.push(div1[5])
		}
		if (i2 == 5) {
			nRecords.push(div2[5])
		}
		nRecords[2][5] = 1
		nRecords[3][5] = 1


		console.log(nRecords)




	function Bambitron(n) {
		i = 0
		while (i < n) {
			generateRecord()
			i = i + 1
		}
		console.log("done")
	}



	

	
	


</script>
